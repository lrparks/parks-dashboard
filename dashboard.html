<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parks & Recreation Commissioner Dashboard - Little Rock, AR</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="styles.css" rel="stylesheet">
    <style>
        body { margin: 0; padding: 0; }
        @media print {
            .no-print { display: none !important; }
            body { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
        }
    </style>
</head>
<body>
    <!-- Navigation Header -->
    <div id="site-header"></div>
    <div id="root"></div>

    <!-- Component Loader (for header only - footer is in React) -->
    <script src="js/components.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            loadSiteComponents({ basePath: 'components', footer: false });
        });
    </script>
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Google Sheets CSV URLs
        const SHEETS_URLS = {
          current: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR7EssEYbL9FMH06UyzCUntYGlCm7xDd3fFdniFI9ELcD7PhdvFMgWor2VAY6yKtlkPnFeoUOOalrt7/pub?gid=1349162393&single=true&output=csv',
          benchmarks: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR7EssEYbL9FMH06UyzCUntYGlCm7xDd3fFdniFI9ELcD7PhdvFMgWor2VAY6yKtlkPnFeoUOOalrt7/pub?gid=2039065708&single=true&output=csv'
        };

        // CORS proxy for local testing (not needed when hosted on GitHub Pages)
        const CORS_PROXY = 'https://corsproxy.io/?';
        const USE_CORS_PROXY = window.location.protocol === 'file:';
        
        const getUrl = (url) => USE_CORS_PROXY ? CORS_PROXY + encodeURIComponent(url) : url;

        // Parse CSV text into rows
        const parseCSV = (text) => {
          const lines = text.split('\n');
          return lines.map(line => {
            const result = [];
            let current = '';
            let inQuotes = false;
            for (let i = 0; i < line.length; i++) {
              const char = line[i];
              if (char === '"') {
                inQuotes = !inQuotes;
              } else if (char === ',' && !inQuotes) {
                result.push(current.trim());
                current = '';
              } else {
                current += char;
              }
            }
            result.push(current.trim());
            return result;
          });
        };

        // Format number with commas
        const fmt = (val) => {
          if (val === null || val === undefined || val === '' || val === 0 || val === '0') return '---';
          const num = Number(val);
          if (isNaN(num)) return val;
          return num.toLocaleString();
        };

        // Format as currency
        const fmtCurrency = (val) => {
          if (val === null || val === undefined || val === '' || val === 0 || val === '0') return '$---';
          const num = Number(val);
          if (isNaN(num)) return val;
          return '$' + num.toLocaleString();
        };

        // Format as percentage
        const fmtPct = (val) => {
          if (val === null || val === undefined || val === '' || val === 0 || val === '0') return '---%';
          return val + '%';
        };

        // Map CSV data to dashboard structure
        const mapDataToDashboard = (csvRows, benchmarkRows) => {
          // Build lookup by metric ID
          const metrics = {};
          csvRows.forEach(row => {
            const id = parseInt(row[0]);
            if (!isNaN(id)) {
              metrics[id] = {
                label: row[1],
                current: row[2],
                py: row[3],
                ytd: row[4],
                pyYtd: row[5],
                notes: row[6]
              };
            }
          });

          // Get report period from CSV header area
          let reportMonth = 'December 2025';
          let priorYearMonth = 'December 2024';
          csvRows.forEach(row => {
            if (row[0] === 'Report Month:') reportMonth = row[1] + ' ' + row[3];
          });

          // Helper to get metric value
          const get = (id, field = 'current') => metrics[id]?.[field] || '';
          const getNum = (id, field = 'current') => Number(metrics[id]?.[field]) || 0;

          // Build benchmarks lookup
          const benchmarks = {};
          benchmarkRows.forEach(row => {
            if (row[0] && row[1]) {
              benchmarks[row[0]] = row[1];
            }
          });

          // Calculate derived values
          const budgetedFTEs = 131;
          const filledPositions = getNum(103, 'current');
          const vacancies = getNum(104, 'current');
          const vacancyRate = filledPositions > 0 ? Math.round((vacancies / budgetedFTEs) * 100) : 0;
          const pitAllocated = 200000;
          const pitSpent = getNum(105, 'ytd');
          const pitRemaining = pitAllocated - pitSpent;
          const pitPctUsed = pitAllocated > 0 ? Math.round((pitSpent / pitAllocated) * 100) : 0;

          return {
            reportMonth: reportMonth,
            priorYearMonth: priorYearMonth,
            
            admin: {
              revenue: { 
                monthly: { current: fmtCurrency(get(101)), priorYear: fmtCurrency(get(101, 'py')), variance: '---%' },
                ytd: { current: fmtCurrency(get(101, 'ytd')), priorYear: fmtCurrency(get(101, 'pyYtd')), variance: '---%' }
              },
              staffing: {
                budgetedFTEs: '131',
                filledPositions: fmt(get(103)),
                vacancies: fmt(get(104)),
                vacancyRate: fmtPct(vacancyRate),
                ftePer10k: { current: filledPositions > 0 ? (filledPositions / 20.26).toFixed(1) : '---', peerBenchmark: '7.9' },
                keyVacancies: ['[Position 1]', '[Position 2]', '[Position 3]'],
              },
              pitFunding: {
                allocated: '$200,000',
                spent: fmtCurrency(pitSpent),
                remaining: fmtCurrency(pitRemaining),
                expirationDate: 'December 31, 2025',
                percentUsed: fmtPct(pitPctUsed),
              },
              accreditation: { status: '---', nextMilestone: '---' },
              trainings: ['[Training 1]', '[Training 2]'],
            },
            
            operations: {
              capitalProjects: [
                { name: '[Project Name]', status: '---', budget: '$---', spent: '$---', completion: '---%', notes: '' },
                { name: '[Project Name]', status: '---', budget: '$---', spent: '$---', completion: '---%', notes: '' },
              ],
              facilityStatus: [
                { facility: '[Facility Name]', status: '---', notes: '' },
              ],
              accountVariance: [
                { account: 'Dev & Maint Admin (104521)', budgeted: '$9,870', actual: '$---', variance: '---%', status: '---' },
                { account: 'Urban Forestry (104525)', budgeted: '$132,406', actual: '$---', variance: '---%', status: '---' },
                { account: 'Horticulture (104524)', budgeted: '$263,682', actual: '$---', variance: '---%', status: '---' },
                { account: 'Park Maintenance (104522)', budgeted: '$---', actual: '$---', variance: '---%', status: '---' },
                { account: 'Operations & Improvement (104523)', budgeted: '$---', actual: '$---', variance: '---%', status: '---' },
              ],
              maintenance: {
                litterCollected: { ytd: fmt(get(201, 'ytd')), priorYtd: fmt(get(201, 'pyYtd')), unit: 'tons' },
                mowingCycles: { completed: fmt(get(202, 'ytd')), scheduled: fmt(get(203)) },
                workOrders: { open: fmt(get(204)), closed: fmt(get(205)), avgDaysToClose: fmt(get(206)) },
              },
              equipment: { status: '---', notes: '' },
            },
            
            recreation: {
              golf: {
                rounds: { current: fmt(get(701)), priorYear: fmt(get(701, 'py')), ytd: fmt(get(701, 'ytd')), priorYtd: fmt(get(701, 'pyYtd')) },
                revenue: {
                  greensFees: { current: fmtCurrency(get(702)), priorYear: fmtCurrency(get(702, 'py')), ytd: fmtCurrency(get(702, 'ytd')) },
                  cartRentals: { current: fmtCurrency(get(703)), priorYear: fmtCurrency(get(703, 'py')), ytd: fmtCurrency(get(703, 'ytd')) },
                  proShopSales: { current: fmtCurrency(get(704)), priorYear: fmtCurrency(get(704, 'py')), ytd: fmtCurrency(get(704, 'ytd')) },
                  lessons: { current: fmtCurrency(get(705)), priorYear: fmtCurrency(get(705, 'py')), ytd: fmtCurrency(get(705, 'ytd')) },
                  total: { current: fmtCurrency(get(708)), priorYear: fmtCurrency(get(708, 'py')), ytd: fmtCurrency(get(708, 'ytd')) },
                },
                utilization: { current: fmtPct(get(706)), target: '50-65%' },
                revenuePerRound: { current: fmtCurrency(get(707)), priorYear: fmtCurrency(get(707, 'py')) },
                costRecovery: { current: '---%', target: '100%+' },
              },
              
              tennis: {
                courtHours: { current: fmt(get(801)), priorYear: fmt(get(801, 'py')), ytd: fmt(get(801, 'ytd')), priorYtd: fmt(get(801, 'pyYtd')) },
                utilization: { current: fmtPct(get(809)), target: '60-70%', primeTime: fmtPct(get(810)) },
                teams: {
                  adultLeagues: { current: fmt(get(802)), priorYear: fmt(get(802, 'py')) },
                  highSchool: { current: fmt(get(803)), priorYear: fmt(get(803, 'py')) },
                  mixedDoubles: { current: fmt(get(804)), priorYear: fmt(get(804, 'py')) },
                  triLevel: { current: fmt(get(805)), priorYear: fmt(get(805, 'py')) },
                },
                tournaments: { current: fmt(get(806)), priorYear: fmt(get(806, 'py')), ytd: fmt(get(806, 'ytd')) },
                revenue: {
                  courtRentals: { current: fmtCurrency(get(807)), ytd: fmtCurrency(get(807, 'ytd')) },
                  tournaments: { current: fmtCurrency(get(808)), ytd: fmtCurrency(get(808, 'ytd')) },
                  total: { current: fmtCurrency(get(811)), ytd: fmtCurrency(get(811, 'ytd')) },
                },
              },
              
              jimDailey: {
                memberships: { current: fmt(get(301)), priorYear: fmt(get(301, 'py')), ytd: fmt(get(301, 'ytd')), priorYtd: fmt(get(301, 'pyYtd')) },
                fitnessVisits: { current: fmt(get(302)), priorYear: fmt(get(302, 'py')), ytd: fmt(get(302, 'ytd')), priorYtd: fmt(get(302, 'pyYtd')) },
                groupFitnessClasses: { count: fmt(get(303)), participation: fmt(get(304)) },
                swimLessons: { current: fmt(get(305)), priorYear: fmt(get(305, 'py')), ytd: fmt(get(305, 'ytd')) },
                poolVisits: { current: fmt(get(306)), priorYear: fmt(get(306, 'py')), ytd: fmt(get(306, 'ytd')) },
                aquaticsClasses: { count: fmt(get(307)), participation: fmt(get(308)) },
                revenue: { current: fmtCurrency(get(309)), priorYear: fmtCurrency(get(309, 'py')), ytd: fmtCurrency(get(309, 'ytd')) },
              },
              
              museum: {
                attendance: { current: fmt(get(501)), priorYear: fmt(get(501, 'py')), ytd: fmt(get(501, 'ytd')), priorYtd: fmt(get(501, 'pyYtd')), annualGoal: '---', percentOfGoal: '---%' },
                fundraising: { ytd: fmtCurrency(get(502, 'ytd')), goal: '$30,000', percentOfGoal: '---%' },
                offSiteProgramming: { reached: fmt(get(503)) },
                events: [
                  { name: 'Vintage Military Vehicle Show', attendance: '---' },
                  { name: 'Movies at MacArthur', attendance: '---' },
                ],
              },
              
              communityCenters: {
                totalParticipants: { current: fmt(get(401)), priorYear: fmt(get(401, 'py')), ytd: fmt(get(401, 'ytd')) },
                centers: [
                  { name: 'Dunbar', participants: fmt(get(402)), programs: '---' },
                  { name: 'Southwest', participants: fmt(get(403)), programs: '---' },
                  { name: 'East Little Rock', participants: fmt(get(404)), programs: '---' },
                  { name: 'West Central', participants: fmt(get(405)), programs: '---' },
                  { name: 'Stephens', participants: fmt(get(406)), programs: '---', status: '---' },
                ],
                therapeuticRec: { participants: fmt(get(407)), priorYear: fmt(get(407, 'py')) },
              },
              
              youthEngagement: {
                summerCamp: { current: fmt(get(601)), priorYear: fmt(get(601, 'py')) },
                soccer: { current: fmt(get(602)), priorYear: fmt(get(602, 'py')) },
                baseball: { current: fmt(get(603)), priorYear: fmt(get(603, 'py')) },
                teeball: { current: fmt(get(604)), priorYear: fmt(get(604, 'py')) },
                flagFootball: { current: fmt(get(605)), priorYear: fmt(get(605, 'py')) },
                cheerleading: { current: fmt(get(606)), priorYear: fmt(get(606, 'py')) },
                trackField: { current: fmt(get(607)), priorYear: fmt(get(607, 'py')) },
                basketball: { current: fmt(get(608)), priorYear: fmt(get(608, 'py')) },
              },
              
              specialEvents: {
                signature: [
                  { name: 'Little Rock Marathon', attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
                ],
                community: [
                  { name: 'Movies at MacArthur', attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
                ],
                revenueGenerating: [
                  { name: 'Paranormal Expo', attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
                ],
                healthFitness: [
                  { name: "Logan's Run", attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
                ],
              },
              
              rentals: {
                pavilionRentals: { current: fmt(get(901)), priorYear: fmt(get(901, 'py')), ytd: fmt(get(901, 'ytd')), priorYtd: fmt(get(901, 'pyYtd')) },
                pavilionRevenue: { current: fmtCurrency(get(902)), priorYear: fmtCurrency(get(902, 'py')), ytd: fmtCurrency(get(902, 'ytd')), priorYtd: fmtCurrency(get(902, 'pyYtd')) },
                suspensionPeriod: 'Nov 1, 2025 - Apr 1, 2026',
              },
              
              outdoorRecreation: {
                placeholder: true,
              },
            },
            
            volunteers: {
              totalHours: { current: fmt(get(1001)), priorYear: fmt(get(1001, 'py')), ytd: fmt(get(1001, 'ytd')), priorYtd: fmt(get(1001, 'pyYtd')) },
              totalVolunteers: { current: fmt(get(1002)), priorYear: fmt(get(1002, 'py')) },
              yoyTrend: '+---%',
              programs: {
                volunteerParkRangers: { hours: fmt(get(1003)), required: '16 hrs/mo', count: fmt(get(1004)) },
                jrParkRangers: { count: fmt(get(1005)), priorYear: fmt(get(1005, 'py')) },
                adoptAPark: { participants: fmt(get(1006)), opportunities: '50+' },
              },
              availablePrograms: '9',
              backgroundChecks: 'Provided for vulnerable populations',
            },
            
            safety: {
              training: { 
                completion: fmtPct(get(1101)), 
                staffCompleted: '---', 
                staffTotal: '---', 
                target: '100%',
                status: getNum(1101) >= 100 ? 'üü¢' : getNum(1101) >= 80 ? 'üü°' : '‚ö†Ô∏è'
              },
              facilityInspections: { 
                completion: fmtPct(get(1102)), 
                completed: '---', 
                total: '22', 
                target: '100%',
                status: getNum(1102) >= 100 ? 'üü¢' : getNum(1102) >= 80 ? 'üü°' : '‚ö†Ô∏è'
              },
              fireSafety: {
                extinguishers: { completion: fmtPct(get(1103)), completed: '---', total: '27', status: getNum(1103) >= 100 ? 'üü¢' : '‚ö†Ô∏è' },
                alarms: { completion: fmtPct(get(1104)), completed: '---', total: '17', status: getNum(1104) >= 100 ? 'üü¢' : '‚ö†Ô∏è' },
                controlPanels: { completion: fmtPct(get(1105)), completed: '---', total: '9', status: getNum(1105) >= 100 ? 'üü¢' : '‚ö†Ô∏è' },
              },
              aed: {
                operationalChecks: { completion: fmtPct(get(1106)), completed: '---', total: '19', status: getNum(1106) >= 100 ? 'üü¢' : '‚ö†Ô∏è' },
                recertsOutstanding: ['[Staff Name 1]', '[Staff Name 2]', '[Staff Name 3]'],
              },
              playgrounds: {
                inspectionsCompleted: fmt(get(1107)),
                inspectionsScheduled: '---',
                historicalRate: '84%',
              },
              activeHazards: [
                { location: '[Location]', issue: '[Issue]', priority: 'HIGH', status: 'Pending' },
              ],
              incidents: { current: fmt(get(1109)), priorYear: fmt(get(1109, 'py')), ytd: fmt(get(1109, 'ytd')) },
            },
            
            budget: {
              operating: { annual: fmtCurrency(get(1201)), ytdBudget: '$---', ytdActual: fmtCurrency(get(1204, 'ytd')), variance: '$---' },
              revenue: { 
                annual: fmtCurrency(get(1202)), 
                ytdBudget: '$---', 
                ytdActual: fmtCurrency(get(1203, 'ytd')), 
                variance: '$---',
                monthly: { current: fmtCurrency(get(1203)), priorYear: fmtCurrency(get(1203, 'py')), variance: '---%' }
              },
              costRecovery: { current: '---%', peerBenchmark: '22%' },
              perCapitaSpend: { current: '$---', peerBenchmark: '$87.10' },
              generalFundPct: { current: '---%', peerBenchmark: '62%' },
            },
            
            peerComparison: {
              metrics: [
                { metric: 'Operating Expenditure per Capita', lr: '$---', nrpaMedian: '$87.10', lowerQuartile: '$39.69', upperQuartile: '$160.76', lrVsMedian: '---' },
                { metric: 'Cost Recovery Ratio', lr: '---%', nrpaMedian: '22%', lowerQuartile: '12.2%', upperQuartile: '38.1%', lrVsMedian: '---' },
                { metric: 'Acres per 1,000 Residents', lr: '31.9', nrpaMedian: '10.2', lowerQuartile: '4.4', upperQuartile: '15.5', lrVsMedian: '+213%' },
                { metric: 'Residents per Park', lr: '2,894', nrpaMedian: '3,344', lowerQuartile: '2,173', upperQuartile: '7,039', lrVsMedian: '-13%' },
                { metric: 'FTEs per 10,000 Residents', lr: '---', nrpaMedian: '7.9', lowerQuartile: '---', upperQuartile: '---', lrVsMedian: '---' },
                { metric: 'General Fund %', lr: '---%', nrpaMedian: '62%', lowerQuartile: '---', upperQuartile: '---', lrVsMedian: '---' },
                { metric: 'Personnel Services % of Budget', lr: '---%', nrpaMedian: '54%', lowerQuartile: '---', upperQuartile: '---', lrVsMedian: '---' },
              ],
              source: 'NRPA 2024 Agency Performance Review (100K-250K population)',
            },
          };
        };

        const Dashboard = () => {
  const [activeTab, setActiveTab] = useState('summary');
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [lastUpdated, setLastUpdated] = useState(null);
  
  // Default data structure (shown while loading or on error)
  const defaultData = {
    reportMonth: 'December 2025',
    priorYearMonth: 'December 2024',
    
    // ==========================================
    // ADMIN DIVISION
    // ==========================================
    admin: {
      revenue: { 
        monthly: { current: '$---', priorYear: '$---', variance: '---%' },
        ytd: { current: '$---', priorYear: '$---', variance: '---%' }
      },
      staffing: {
        budgetedFTEs: '131',
        filledPositions: '---',
        vacancies: '---',
        vacancyRate: '---%',
        ftePer10k: { current: '---', peerBenchmark: '7.9' },
        keyVacancies: ['[Position 1]', '[Position 2]', '[Position 3]'],
      },
      pitFunding: {
        allocated: '$200,000',
        spent: '$---',
        remaining: '$---',
        expirationDate: 'December 31, 2025',
        percentUsed: '---%',
      },
      accreditation: { status: '---', nextMilestone: '---' },
      trainings: ['[Training 1]', '[Training 2]'],
    },
    
    // ==========================================
    // OPERATIONS DIVISION
    // ==========================================
    operations: {
      capitalProjects: [
        { name: '[Project Name]', status: '---', budget: '$---', spent: '$---', completion: '---%', notes: '' },
        { name: '[Project Name]', status: '---', budget: '$---', spent: '$---', completion: '---%', notes: '' },
        { name: '[Project Name]', status: '---', budget: '$---', spent: '$---', completion: '---%', notes: '' },
        { name: '[Project Name]', status: '---', budget: '$---', spent: '$---', completion: '---%', notes: '' },
      ],
      facilityStatus: [
        { facility: '[Facility Name]', status: '---', notes: '' },
        { facility: '[Facility Name]', status: '---', notes: '' },
      ],
      accountVariance: [
        { account: 'Dev & Maint Admin (104521)', budgeted: '$9,870', actual: '$---', variance: '---%', status: '---' },
        { account: 'Urban Forestry (104525)', budgeted: '$132,406', actual: '$---', variance: '---%', status: '---' },
        { account: 'Horticulture (104524)', budgeted: '$263,682', actual: '$---', variance: '---%', status: '---' },
        { account: 'Park Maintenance (104522)', budgeted: '$---', actual: '$---', variance: '---%', status: '---' },
        { account: 'Operations & Improvement (104523)', budgeted: '$---', actual: '$---', variance: '---%', status: '---' },
      ],
      maintenance: {
        litterCollected: { ytd: '---', priorYtd: '---', unit: 'tons' },
        mowingCycles: { completed: '---', scheduled: '---' },
        workOrders: { open: '---', closed: '---', avgDaysToClose: '---' },
      },
      equipment: { status: '---', notes: '' },
    },
    
    // ==========================================
    // RECREATION DIVISION
    // ==========================================
    recreation: {
      // GOLF (Rebsamen + First Tee)
      golf: {
        rounds: { current: '---', priorYear: '---', ytd: '---', priorYtd: '---' },
        revenue: {
          greensFees: { current: '$---', priorYear: '$---', ytd: '$---' },
          cartRentals: { current: '$---', priorYear: '$---', ytd: '$---' },
          proShopSales: { current: '$---', priorYear: '$---', ytd: '$---' },
          lessons: { current: '$---', priorYear: '$---', ytd: '$---' },
          total: { current: '$---', priorYear: '$---', ytd: '$---' },
        },
        utilization: { current: '---%', target: '50-65%' },
        revenuePerRound: { current: '$---', priorYear: '$---' },
        costRecovery: { current: '---%', target: '100%+' },
      },
      
      // TENNIS (Rebsamen Tennis Center)
      tennis: {
        courtHours: { current: '---', priorYear: '---', ytd: '---', priorYtd: '---' },
        utilization: { current: '---%', target: '60-70%', primeTime: '---%' },
        teams: {
          adultLeagues: { current: '---', priorYear: '---' },
          highSchool: { current: '---', priorYear: '---' },
          mixedDoubles: { current: '---', priorYear: '---' },
          triLevel: { current: '---', priorYear: '---' },
        },
        tournaments: { current: '---', priorYear: '---', ytd: '---' },
        revenue: {
          courtRentals: { current: '$---', ytd: '$---' },
          tournaments: { current: '$---', ytd: '$---' },
          total: { current: '$---', ytd: '$---' },
        },
      },
      
      // JIM DAILEY FITNESS & AQUATICS
      jimDailey: {
        memberships: { current: '---', priorYear: '---', ytd: '---', priorYtd: '---' },
        fitnessVisits: { current: '---', priorYear: '---', ytd: '---', priorYtd: '---' },
        groupFitnessClasses: { count: '---', participation: '---' },
        swimLessons: { current: '---', priorYear: '---', ytd: '---' },
        poolVisits: { current: '---', priorYear: '---', ytd: '---' },
        aquaticsClasses: { count: '---', participation: '---' },
        revenue: { current: '$---', priorYear: '$---', ytd: '$---' },
      },
      
      // MUSEUM OF MILITARY HISTORY
      museum: {
        attendance: { current: '---', priorYear: '---', ytd: '---', priorYtd: '---', annualGoal: '---', percentOfGoal: '---%' },
        fundraising: { ytd: '$---', goal: '$30,000', percentOfGoal: '---%' },
        offSiteProgramming: { reached: '---' },
        events: [
          { name: 'Vintage Military Vehicle Show', attendance: '---' },
          { name: 'Movies at MacArthur', attendance: '---' },
        ],
      },
      
      // COMMUNITY CENTERS
      communityCenters: {
        totalParticipants: { current: '---', priorYear: '---', ytd: '---' },
        centers: [
          { name: 'Dunbar', participants: '---', programs: '---' },
          { name: 'Southwest', participants: '---', programs: '---' },
          { name: 'East Little Rock', participants: '---', programs: '---' },
          { name: 'West Central', participants: '---', programs: '---' },
          { name: 'Stephens', participants: '---', programs: '---', status: '---' },
        ],
        therapeuticRec: { participants: '---', priorYear: '---' },
      },
      
      // YOUTH ENGAGEMENT (renamed from Youth Sports)
      youthEngagement: {
        summerCamp: { current: '---', priorYear: '---' },
        soccer: { current: '---', priorYear: '---' },
        baseball: { current: '---', priorYear: '---' },
        teeball: { current: '---', priorYear: '---' },
        flagFootball: { current: '---', priorYear: '---' },
        cheerleading: { current: '---', priorYear: '---' },
        trackField: { current: '---', priorYear: '---' },
        basketball: { current: '---', priorYear: '---' },
      },
      
      // SPECIAL EVENTS (categorized)
      specialEvents: {
        signature: [
          { name: 'Little Rock Marathon', attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
        ],
        community: [
          { name: 'Movies at MacArthur', attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
          { name: '[Holiday Event]', attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
        ],
        revenueGenerating: [
          { name: 'Paranormal Expo', attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
          { name: 'Vintage Military Vehicle Show', attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
        ],
        healthFitness: [
          { name: "Logan's Run", attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
          { name: 'Squatch Till You Drop Trail Run', attendance: '---', priorYear: '---', revenue: '$---', date: '---' },
        ],
      },
      
      // RENTALS
      rentals: {
        pavilionRentals: { current: '---', priorYear: '---', ytd: '---', priorYtd: '---' },
        pavilionRevenue: { current: '$---', priorYear: '$---', ytd: '$---', priorYtd: '$---' },
        suspensionPeriod: 'Nov 1, 2025 - Apr 1, 2026',
      },
      
      // OUTDOOR RECREATION (NEW - placeholder)
      outdoorRecreation: {
        // Metrics to be defined as position develops
        placeholder: true,
      },
    },
    
    // ==========================================
    // VOLUNTEER DIVISION
    // ==========================================
    volunteers: {
      totalHours: { current: '---', priorYear: '---', ytd: '---', priorYtd: '---' },
      totalVolunteers: { current: '---', priorYear: '---' },
      yoyTrend: '+6%',
      programs: {
        volunteerParkRangers: { hours: '---', required: '16 hrs/mo', count: '---' },
        jrParkRangers: { count: '---', priorYear: '---' },
        adoptAPark: { participants: '---', opportunities: '50+' },
      },
      availablePrograms: '9',
      backgroundChecks: 'Provided for vulnerable populations',
    },
    
    // ==========================================
    // SAFETY DIVISION
    // ==========================================
    safety: {
      training: { 
        completion: '---%', 
        staffCompleted: '---', 
        staffTotal: '---', 
        target: '100%',
        status: '√¢≈°¬†√Ø¬∏¬è' 
      },
      facilityInspections: { 
        completion: '---%', 
        completed: '---', 
        total: '22', 
        target: '100%',
        status: '√¢≈°¬†√Ø¬∏¬è' 
      },
      fireSafety: {
        extinguishers: { completion: '---%', completed: '---', total: '27', status: '√¢≈°¬†√Ø¬∏¬è' },
        alarms: { completion: '---%', completed: '---', total: '17', status: '√¢≈°¬†√Ø¬∏¬è' },
        controlPanels: { completion: '---%', completed: '---', total: '9', status: '√¢≈°¬†√Ø¬∏¬è' },
      },
      aed: {
        operationalChecks: { completion: '---%', completed: '---', total: '19', status: '√¢≈°¬†√Ø¬∏¬è' },
        recertsOutstanding: ['[Staff Name 1]', '[Staff Name 2]', '[Staff Name 3]'],
      },
      playgrounds: {
        inspectionsCompleted: '---',
        inspectionsScheduled: '---',
        historicalRate: '84%',
      },
      activeHazards: [
        { location: 'Centennial Park', issue: 'Slide parts unavailable - removal considered', priority: 'HIGH', status: 'Pending Decision' },
        { location: 'Butler Park', issue: 'Flexible tunnel breaking at hinge points', priority: 'HIGH', status: 'Removal Needed' },
        { location: 'Southwest CC', issue: 'Safety surfacing gone in swing zone, concrete exposed', priority: 'HIGH', status: 'Immediate' },
      ],
      incidents: { current: '---', priorYear: '---', ytd: '---' },
    },
    
    // ==========================================
    // BUDGET & FINANCIAL
    // ==========================================
    budget: {
      operating: { annual: '$---', ytdBudget: '$---', ytdActual: '$---', variance: '$---' },
      revenue: { 
        annual: '$---', 
        ytdBudget: '$---', 
        ytdActual: '$---', 
        variance: '$---',
        monthly: { current: '$---', priorYear: '$---', variance: '---%' }
      },
      costRecovery: { current: '---%', peerBenchmark: '22%' },
      perCapitaSpend: { current: '$---', peerBenchmark: '$87.10' },
      generalFundPct: { current: '---%', peerBenchmark: '62%' },
    },
    
    // ==========================================
    // LR vs PEERS COMPARISON
    // ==========================================
    peerComparison: {
      metrics: [
        { metric: 'Operating Expenditure per Capita', lr: '$---', nrpaMedian: '$87.10', lowerQuartile: '$39.69', upperQuartile: '$160.76', lrVsMedian: '---' },
        { metric: 'Cost Recovery Ratio', lr: '---%', nrpaMedian: '22%', lowerQuartile: '12.2%', upperQuartile: '38.1%', lrVsMedian: '---' },
        { metric: 'Acres per 1,000 Residents', lr: '---', nrpaMedian: '7.0', lowerQuartile: '4.4', upperQuartile: '15.5', lrVsMedian: '---' },
        { metric: 'Residents per Park', lr: '---', nrpaMedian: '3,344', lowerQuartile: '2,173', upperQuartile: '7,039', lrVsMedian: '---' },
        { metric: 'FTEs per 10,000 Residents', lr: '---', nrpaMedian: '7.9', lowerQuartile: '---', upperQuartile: '---', lrVsMedian: '---' },
        { metric: 'General Fund %', lr: '---%', nrpaMedian: '62%', lowerQuartile: '---', upperQuartile: '---', lrVsMedian: '---' },
        { metric: 'Personnel Services % of Budget', lr: '---%', nrpaMedian: '54%', lowerQuartile: '---', upperQuartile: '---', lrVsMedian: '---' },
      ],
      source: 'NRPA 2024 Agency Performance Review (100K-250K population)',
    },
  };

  // State for actual data (starts with defaults, updated from Sheets)
  const [data, setData] = useState(defaultData);

  // Fetch data from Google Sheets on mount
  useEffect(() => {
    const fetchData = async () => {
      try {
        setLoading(true);
        setError(null);

        // Fetch both CSVs in parallel
        const [currentRes, benchmarksRes] = await Promise.all([
          fetch(getUrl(SHEETS_URLS.current)),
          fetch(getUrl(SHEETS_URLS.benchmarks))
        ]);

        if (!currentRes.ok || !benchmarksRes.ok) {
          throw new Error('Failed to fetch data from Google Sheets');
        }

        const currentText = await currentRes.text();
        const benchmarksText = await benchmarksRes.text();

        const currentRows = parseCSV(currentText);
        const benchmarkRows = parseCSV(benchmarksText);

        // Map CSV data to dashboard structure
        const mappedData = mapDataToDashboard(currentRows, benchmarkRows);
        setData(mappedData);
        setLastUpdated(new Date().toLocaleString());
        setLoading(false);
      } catch (err) {
        console.error('Error fetching data:', err);
        setError(err.message);
        setLoading(false);
      }
    };

    fetchData();
  }, []);

  // Refresh function
  const handleRefresh = () => {
    setLoading(true);
    window.location.reload();
  };

  // ==========================================
  // COMPONENT HELPERS
  // ==========================================
  
  const MetricCard = ({ title, children, className = '', icon = '' }) => (
    <div className={`bg-white rounded-lg shadow-md p-4 ${className}`}>
      <h3 className="text-sm font-semibold text-gray-600 uppercase tracking-wide mb-3 border-b pb-2">
        {icon && <span className="mr-1">{icon}</span>}{title}
      </h3>
      {children}
    </div>
  );

  const StatusBadge = ({ status }) => {
    const colors = {
      '√∞≈∏≈∏¬¢': 'bg-green-100 text-green-800',
      '√∞≈∏≈∏¬°': 'bg-yellow-100 text-yellow-800',
      '√∞≈∏‚Äù¬¥': 'bg-red-100 text-red-800',
      '√¢≈°¬†√Ø¬∏¬è': 'bg-orange-100 text-orange-800',
      'On Track': 'bg-green-100 text-green-800',
      'At Risk': 'bg-yellow-100 text-yellow-800',
      'Over Budget': 'bg-red-100 text-red-800',
      'Complete': 'bg-blue-100 text-blue-800',
      'In Progress': 'bg-purple-100 text-purple-800',
      'Pending Decision': 'bg-yellow-100 text-yellow-800',
      'Removal Needed': 'bg-orange-100 text-orange-800',
      'Immediate': 'bg-red-100 text-red-800',
      'Open': 'bg-green-100 text-green-800',
      'Closed': 'bg-gray-100 text-gray-600',
      'HIGH': 'bg-red-100 text-red-800',
      'MEDIUM': 'bg-yellow-100 text-yellow-800',
      'LOW': 'bg-green-100 text-green-800',
      '---': 'bg-gray-100 text-gray-500',
    };
    return (
      <span className={`px-2 py-1 rounded text-xs font-medium ${colors[status] || colors['---']}`}>
        {status}
      </span>
    );
  };

  const DataRow = ({ label, current, priorYear, benchmark }) => (
    <div className="flex justify-between items-center py-2 border-b border-gray-100 last:border-0">
      <span className="text-sm text-gray-700">{label}</span>
      <div className="flex gap-4 text-sm">
        <span className="w-20 text-right font-semibold">{current}</span>
        {priorYear && <span className="w-20 text-right text-gray-500">{priorYear}</span>}
        {benchmark && <span className="w-20 text-right text-blue-600 text-xs">{benchmark}</span>}
      </div>
    </div>
  );

  const ComplianceRow = ({ label, completion, completed, total, status }) => (
    <div className="flex justify-between items-center py-2 border-b border-gray-100 last:border-0">
      <span className="text-sm text-gray-700">{label}</span>
      <div className="flex items-center gap-3">
        <span className="text-xs text-gray-500">{completed}/{total}</span>
        <span className="font-semibold w-12 text-right">{completion}</span>
        <StatusBadge status={status} />
      </div>
    </div>
  );

  const StatBox = ({ value, label, sublabel, color = 'gray' }) => {
    const colors = {
      gray: 'bg-gray-50',
      green: 'bg-green-50 text-green-700',
      orange: 'bg-orange-50 text-orange-600',
      blue: 'bg-blue-50 text-blue-600',
      purple: 'bg-purple-50 text-purple-700',
      red: 'bg-red-50 text-red-600',
      yellow: 'bg-yellow-50 text-yellow-700',
    };
    return (
      <div className={`text-center p-3 rounded-lg ${colors[color]}`}>
        <div className="text-2xl font-bold">{value}</div>
        <div className="text-xs text-gray-500">{label}</div>
        {sublabel && <div className="text-xs text-gray-400">{sublabel}</div>}
      </div>
    );
  };

  const tabs = [
    { id: 'summary', label: 'Summary' },
    { id: 'ytd', label: 'YTD' },
    { id: 'admin', label: 'Admin' },
    { id: 'operations', label: 'Operations' },
    { id: 'recreation', label: 'Recreation' },
    { id: 'volunteer', label: 'Volunteer' },
    { id: 'safety', label: 'Safety' },
    { id: 'budget', label: 'Budget' },
    { id: 'peers', label: 'LR vs Peers' },
  ];

  // ==========================================
  // RENDER
  // ==========================================
  
  return (
    <div className="min-h-screen bg-gray-100 p-4">
      {/* Header */}
      <div className="mb-4">
        <h1 className="text-xl font-bold text-gray-800">Parks & Recreation Commissioner Dashboard</h1>
        <p className="text-gray-600 text-sm">Little Rock, Arkansas</p>
        <div className="flex flex-wrap gap-1 mt-3">
          {tabs.map((tab) => (
            <button
              key={tab.id}
              onClick={() => setActiveTab(tab.id)}
              className={`px-3 py-1.5 rounded-lg font-medium transition text-xs ${
                activeTab === tab.id ? 'bg-green-600 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'
              }`}
            >
              {tab.label}
            </button>
          ))}
        </div>
      </div>

      {/* Loading State */}
      {loading && (
        <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 flex items-center gap-3">
          <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"></div>
          <span className="text-blue-700">Loading data from Google Sheets...</span>
        </div>
      )}

      {/* Error State */}
      {error && (
        <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-4">
          <span className="text-red-700">‚ö†Ô∏è Error loading data: {error}. Showing default values.</span>
        </div>
      )}

      {/* Report Period Header */}
      <div className="bg-green-700 text-white rounded-lg p-3 mb-4 flex flex-wrap justify-between items-center text-sm gap-2">
        <div><span className="opacity-80">Report:</span> <span className="font-semibold">{data.reportMonth}</span></div>
        <div><span className="opacity-80">vs:</span> <span>{data.priorYearMonth}</span></div>
        <div className="flex items-center gap-2">
          {lastUpdated && <span className="text-xs opacity-70">Updated: {lastUpdated}</span>}
          <button 
            onClick={handleRefresh}
            className="bg-green-600 hover:bg-green-500 px-2 py-1 rounded text-xs transition"
          >
            ‚Üª Refresh
          </button>
          <div className={`px-2 py-1 rounded text-xs ${loading ? 'bg-yellow-500' : error ? 'bg-red-500' : 'bg-green-500'}`}>
            {loading ? '‚è≥ LOADING...' : error ? '‚ö†Ô∏è ERROR' : '‚úì LIVE DATA'}
          </div>
        </div>
      </div>

      {/* ==========================================
          TAB: SUMMARY (Monthly Snapshot)
          ========================================== */}
      {activeTab === 'summary' && (
        <div className="space-y-3">
          {/* QUICK STATS - Compact 6-indicator row */}
          <div className="grid grid-cols-3 md:grid-cols-6 gap-2">
            <div className="bg-green-50 rounded-lg p-2 text-center">
              <div className="text-lg font-bold text-green-700">{data.admin.revenue.monthly.current}</div>
              <div className="text-xs text-gray-500">Revenue</div>
              <div className="text-xs text-gray-400">{data.admin.revenue.monthly.variance} YoY</div>
            </div>
            <div className="bg-gray-50 rounded-lg p-2 text-center">
              <div className="text-lg font-bold text-gray-700">{data.admin.staffing.filledPositions}/{data.admin.staffing.budgetedFTEs}</div>
              <div className="text-xs text-gray-500">Staffing</div>
              <div className="text-xs text-gray-400">{data.admin.staffing.vacancyRate} vacant</div>
            </div>
            <div className="bg-orange-50 rounded-lg p-2 text-center">
              <div className="text-lg font-bold text-orange-600">{data.admin.staffing.vacancies}</div>
              <div className="text-xs text-gray-500">Vacancies</div>
              <div className="text-xs text-orange-500">√¢≈°¬†√Ø¬∏¬è</div>
            </div>
            <div className="bg-orange-50 rounded-lg p-2 text-center">
              <div className="text-lg font-bold text-orange-600">{data.safety.training.completion}</div>
              <div className="text-xs text-gray-500">Safety Training</div>
              <div className="text-xs text-orange-500">√¢≈°¬†√Ø¬∏¬è</div>
            </div>
            <div className="bg-red-50 rounded-lg p-2 text-center">
              <div className="text-lg font-bold text-red-600">{data.safety.activeHazards.length}</div>
              <div className="text-xs text-gray-500">Hazards</div>
              <div className="text-xs text-red-500">√∞≈∏‚Äù¬¥</div>
            </div>
            <div className="bg-yellow-50 rounded-lg p-2 text-center">
              <div className="text-lg font-bold text-yellow-700">{data.summary?.facilityClosure || '1'}</div>
              <div className="text-xs text-gray-500">Closures</div>
              <div className="text-xs text-yellow-500">√∞≈∏≈∏¬°</div>
            </div>
          </div>

          {/* ECONOMIC DRIVERS - 2x2 Compact Grid */}
          <div className="bg-white rounded-lg shadow-md p-3">
            <h3 className="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">√∞≈∏‚Äô¬∞ Economic Drivers</h3>
            <div className="grid grid-cols-2 gap-3">
              {/* Jim Dailey */}
              <div className="bg-gray-50 rounded p-2">
                <div className="flex items-center gap-1 mb-1">
                  <span>√∞≈∏¬è‚Äπ√Ø¬∏¬è</span>
                  <span className="text-xs font-semibold text-gray-700">Jim Dailey Fitness</span>
                </div>
                <div className="space-y-0.5 text-xs">
                  <div className="flex justify-between"><span className="text-gray-500">Memberships</span><span className="font-semibold">{data.recreation.jimDailey.memberships.current}</span></div>
                  <div className="flex justify-between"><span className="text-gray-500">Visits</span><span className="font-semibold">{data.recreation.jimDailey.fitnessVisits.current}</span></div>
                  <div className="flex justify-between"><span className="text-gray-500">Revenue</span><span className="font-semibold text-green-600">{data.recreation.jimDailey.revenue.current}</span></div>
                </div>
              </div>
              
              {/* Golf */}
              <div className="bg-gray-50 rounded p-2">
                <div className="flex items-center gap-1 mb-1">
                  <span>√¢‚Ä∫¬≥</span>
                  <span className="text-xs font-semibold text-gray-700">Golf (Rebsamen + First Tee)</span>
                </div>
                <div className="space-y-0.5 text-xs">
                  <div className="flex justify-between"><span className="text-gray-500">Rounds</span><span className="font-semibold">{data.recreation.golf.rounds.current}</span></div>
                  <div className="flex justify-between"><span className="text-gray-500">Utilization</span><span className="font-semibold">{data.recreation.golf.utilization.current}</span></div>
                  <div className="flex justify-between"><span className="text-gray-500">Revenue</span><span className="font-semibold text-green-600">{data.recreation.golf.revenue.total.current}</span></div>
                </div>
              </div>
              
              {/* Tennis */}
              <div className="bg-gray-50 rounded p-2">
                <div className="flex items-center gap-1 mb-1">
                  <span>√∞≈∏≈Ω¬æ</span>
                  <span className="text-xs font-semibold text-gray-700">Tennis (Rebsamen)</span>
                </div>
                <div className="space-y-0.5 text-xs">
                  <div className="flex justify-between"><span className="text-gray-500">Court Hours</span><span className="font-semibold">{data.recreation.tennis.courtHours.current}</span></div>
                  <div className="flex justify-between"><span className="text-gray-500">Tournaments</span><span className="font-semibold">{data.recreation.tennis.tournaments.current}</span></div>
                  <div className="flex justify-between"><span className="text-gray-500">Revenue</span><span className="font-semibold text-green-600">{data.recreation.tennis.revenue.total.current}</span></div>
                </div>
              </div>
              
              {/* Museum */}
              <div className="bg-gray-50 rounded p-2">
                <div className="flex items-center gap-1 mb-1">
                  <span>√∞≈∏¬è‚Ä∫√Ø¬∏¬è</span>
                  <span className="text-xs font-semibold text-gray-700">Museum of Military History</span>
                </div>
                <div className="space-y-0.5 text-xs">
                  <div className="flex justify-between"><span className="text-gray-500">Attendance</span><span className="font-semibold">{data.recreation.museum.attendance.current}</span></div>
                  <div className="flex justify-between"><span className="text-gray-500">YTD vs Goal</span><span className="font-semibold text-green-600">{data.recreation.museum.attendance.percentOfGoal}</span></div>
                  <div className="flex justify-between"><span className="text-gray-500">Fundraising</span><span className="font-semibold text-green-600">{data.recreation.museum.fundraising.percentOfGoal}</span></div>
                </div>
              </div>
            </div>
          </div>

          {/* COMMUNITY ENGAGEMENT - Youth + Volunteer side by side */}
          <div className="grid grid-cols-2 gap-3">
            {/* Youth Engagement */}
            <div className="bg-white rounded-lg shadow-md p-3">
              <h3 className="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">√∞≈∏‚Äò¬¶ Youth Engagement</h3>
              <div className="grid grid-cols-2 gap-2">
                <div className="bg-blue-50 rounded p-2 text-center">
                  <div className="text-xl font-bold text-blue-700">{data.recreation.youthEngagement.summerCamp.current}</div>
                  <div className="text-xs text-gray-500">Summer Camp</div>
                  <div className="text-xs text-gray-400">PY: {data.recreation.youthEngagement.summerCamp.priorYear}</div>
                </div>
                <div className="bg-blue-50 rounded p-2 text-center">
                  <div className="text-xl font-bold text-blue-700">{data.summary?.youthSportsTotal || '---'}</div>
                  <div className="text-xs text-gray-500">Sports (7 programs)</div>
                  <div className="text-xs text-gray-400">PY: ---</div>
                </div>
              </div>
            </div>
            
            {/* Volunteer Impact */}
            <div className="bg-white rounded-lg shadow-md p-3">
              <h3 className="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">√∞≈∏¬§¬ù Volunteer Impact</h3>
              <div className="grid grid-cols-2 gap-2">
                <div className="bg-purple-50 rounded p-2 text-center">
                  <div className="text-xl font-bold text-purple-700">{data.volunteers.totalHours.ytd}</div>
                  <div className="text-xs text-gray-500">Hours YTD</div>
                  <div className="text-xs text-purple-500">{data.volunteers.yoyTrend} YoY</div>
                </div>
                <div className="bg-purple-50 rounded p-2 text-center">
                  <div className="text-xl font-bold text-purple-700">{data.volunteers.totalVolunteers.current}</div>
                  <div className="text-xs text-gray-500">Active</div>
                  <div className="text-xs text-gray-400">{data.volunteers.programs.jrParkRangers.count} Jr. Rangers</div>
                </div>
              </div>
            </div>
          </div>

          {/* CAPITAL PROJECTS - Traffic Light List */}
          <div className="bg-white rounded-lg shadow-md p-3">
            <h3 className="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">√∞≈∏¬è‚Äî√Ø¬∏¬è Capital Projects</h3>
            <div className="space-y-1">
              {data.operations.capitalProjects.map((project, idx) => (
                <div key={idx} className="flex items-center gap-2 text-xs py-1 border-b border-gray-50 last:border-0">
                  <span className={`w-2 h-2 rounded-full ${
                    project.status === 'Complete' ? 'bg-green-500' :
                    project.status === 'In Progress' ? 'bg-yellow-500' :
                    project.status === 'At Risk' ? 'bg-red-500' :
                    'bg-gray-300'
                  }`}></span>
                  <span className="flex-1 text-gray-700">{project.name}</span>
                  <span className="text-gray-400">{project.completion}</span>
                </div>
              ))}
            </div>
          </div>

          {/* ITEMS REQUIRING ATTENTION */}
          <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
            <h4 className="font-semibold text-yellow-800 text-xs mb-2">√¢≈°¬†√Ø¬∏¬è Items Requiring Attention</h4>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-2 text-xs">
              <div className="flex justify-between"><span>PIT Funding:</span><span className="font-semibold">{data.admin.pitFunding.remaining} expires {data.admin.pitFunding.expirationDate}</span></div>
              <div className="flex justify-between"><span>Safety Training:</span><span className="font-semibold text-orange-600">{data.safety.training.completion} (target 100%)</span></div>
              <div className="flex justify-between"><span>Fire Alarm Checks:</span><span className="font-semibold text-red-600">{data.safety.fireSafety.alarms.completion} (critical)</span></div>
            </div>
          </div>
        </div>
      )}

      {/* ==========================================
          TAB: YTD
          ========================================== */}
      {activeTab === 'ytd' && (
        <div className="space-y-4">
          <MetricCard title="Year-to-Date: Programs & Facilities" icon="√∞≈∏‚Äú≈†">
            <div className="mb-2 flex justify-end gap-4 text-xs text-gray-500 font-medium">
              <span className="w-20 text-right">YTD 2025</span>
              <span className="w-20 text-right">YTD 2024</span>
            </div>
            <DataRow label="Golf Rounds" current={data.recreation.golf.rounds.ytd} priorYear={data.recreation.golf.rounds.priorYtd} />
            <DataRow label="Tennis Court Hours" current={data.recreation.tennis.courtHours.ytd} priorYear={data.recreation.tennis.courtHours.priorYtd} />
            <DataRow label="Gym Memberships" current={data.recreation.jimDailey.memberships.ytd} priorYear={data.recreation.jimDailey.memberships.priorYtd} />
            <DataRow label="Fitness Visits" current={data.recreation.jimDailey.fitnessVisits.ytd} priorYear={data.recreation.jimDailey.fitnessVisits.priorYtd} />
            <DataRow label="Museum Attendance" current={data.recreation.museum.attendance.ytd} priorYear={data.recreation.museum.attendance.priorYtd} />
            <DataRow label="Pavilion Rentals" current={data.recreation.rentals.pavilionRentals.ytd} priorYear={data.recreation.rentals.pavilionRentals.priorYtd} />
          </MetricCard>

          <MetricCard title="Year-to-Date: Volunteer Impact" icon="√∞≈∏¬§¬ù">
            <div className="grid grid-cols-2 gap-4">
              <StatBox value={data.volunteers.totalHours.ytd} label="Total Volunteer Hours" sublabel={`PY: ${data.volunteers.totalHours.priorYtd}`} color="purple" />
              <StatBox value={data.volunteers.yoyTrend} label="YoY Change" sublabel="vs Q1-Q3 2024" color="purple" />
            </div>
          </MetricCard>

          <MetricCard title="Year-to-Date: Financial" icon="√∞≈∏‚Äô¬∞">
            <div className="grid grid-cols-2 gap-6">
              <div>
                <h4 className="text-sm font-medium text-gray-700 mb-3">Expenditures</h4>
                <DataRow label="Annual Budget" current={data.budget.operating.annual} />
                <DataRow label="YTD Actual" current={data.budget.operating.ytdActual} />
                <DataRow label="% Used" current="---%" />
              </div>
              <div>
                <h4 className="text-sm font-medium text-gray-700 mb-3">Revenue</h4>
                <DataRow label="Annual Target" current={data.budget.revenue.annual} />
                <DataRow label="YTD Actual" current={data.budget.revenue.ytdActual} />
                <DataRow label="% Achieved" current="---%" />
              </div>
            </div>
          </MetricCard>
        </div>
      )}

      {/* ==========================================
          TAB: ADMIN DIVISION
          ========================================== */}
      {activeTab === 'admin' && (
        <div className="space-y-4">
          <MetricCard title="Revenue" icon="√∞≈∏‚Äô¬µ">
            <div className="grid grid-cols-2 gap-4">
              <div>
                <h4 className="text-sm font-medium text-gray-700 mb-2">Monthly</h4>
                <DataRow label="Current" current={data.admin.revenue.monthly.current} />
                <DataRow label="Prior Year" current={data.admin.revenue.monthly.priorYear} />
                <DataRow label="Variance" current={data.admin.revenue.monthly.variance} />
              </div>
              <div>
                <h4 className="text-sm font-medium text-gray-700 mb-2">Year-to-Date</h4>
                <DataRow label="Current" current={data.admin.revenue.ytd.current} />
                <DataRow label="Prior Year" current={data.admin.revenue.ytd.priorYear} />
                <DataRow label="Variance" current={data.admin.revenue.ytd.variance} />
              </div>
            </div>
          </MetricCard>

          <MetricCard title="Staffing" icon="√∞≈∏‚Äò¬•">
            <div className="grid grid-cols-3 gap-3 mb-4">
              <StatBox value={data.admin.staffing.filledPositions} label="Filled" sublabel={`of ${data.admin.staffing.budgetedFTEs}`} color="gray" />
              <StatBox value={data.admin.staffing.vacancies} label="Vacancies" sublabel={data.admin.staffing.vacancyRate} color="orange" />
              <StatBox value={data.admin.staffing.ftePer10k.current} label="FTE per 10K" sublabel={`Peer: ${data.admin.staffing.ftePer10k.peerBenchmark}`} color="blue" />
            </div>
            <div>
              <span className="text-xs text-gray-500 font-medium">KEY VACANCIES:</span>
              <div className="flex flex-wrap gap-2 mt-2">
                {data.admin.staffing.keyVacancies.map((pos, idx) => (
                  <span key={idx} className="px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded">{pos}</span>
                ))}
              </div>
            </div>
          </MetricCard>

          <MetricCard title="PIT Funding Tracker" icon="√¢¬è¬∞">
            <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
              <div className="flex justify-between items-start mb-3">
                <div>
                  <h4 className="font-semibold text-yellow-800 text-sm">Prevention, Intervention & Treatment Fund</h4>
                  <p className="text-xs text-yellow-600">Expires: {data.admin.pitFunding.expirationDate}</p>
                </div>
                <div className="text-right">
                  <div className="text-xl font-bold text-yellow-800">{data.admin.pitFunding.percentUsed}</div>
                  <div className="text-xs text-yellow-600">Utilized</div>
                </div>
              </div>
              <div className="grid grid-cols-3 gap-3">
                <StatBox value={data.admin.pitFunding.allocated} label="Allocated" color="gray" />
                <StatBox value={data.admin.pitFunding.spent} label="Spent" color="green" />
                <StatBox value={data.admin.pitFunding.remaining} label="Remaining" color="red" />
              </div>
            </div>
          </MetricCard>

          <MetricCard title="Accreditation & Training" icon="√∞≈∏‚Äú≈ì">
            <DataRow label="Accreditation Status" current={data.admin.accreditation.status} />
            <DataRow label="Next Milestone" current={data.admin.accreditation.nextMilestone} />
            <div className="mt-3">
              <span className="text-xs text-gray-500 font-medium">RECENT TRAININGS:</span>
              <div className="flex flex-wrap gap-2 mt-2">
                {data.admin.trainings.map((t, idx) => (
                  <span key={idx} className="px-2 py-1 bg-blue-50 text-blue-600 text-xs rounded">{t}</span>
                ))}
              </div>
            </div>
          </MetricCard>
        </div>
      )}

      {/* ==========================================
          TAB: OPERATIONS DIVISION
          ========================================== */}
      {activeTab === 'operations' && (
        <div className="space-y-4">
          <MetricCard title="Maintenance" icon="√∞≈∏‚Äù¬ß">
            <div className="grid grid-cols-3 gap-3">
              <StatBox value={data.operations.maintenance.litterCollected.ytd} label={`Litter (${data.operations.maintenance.litterCollected.unit})`} sublabel={`PY: ${data.operations.maintenance.litterCollected.priorYtd}`} color="gray" />
              <StatBox value={`${data.operations.maintenance.mowingCycles.completed}/${data.operations.maintenance.mowingCycles.scheduled}`} label="Mowing Cycles" color="gray" />
              <StatBox value={data.operations.maintenance.workOrders.open} label="Open Work Orders" color="orange" />
            </div>
          </MetricCard>

          <MetricCard title="Capital Projects" icon="√∞≈∏¬è‚Äî√Ø¬∏¬è">
            <table className="w-full text-sm">
              <thead>
                <tr className="text-left text-gray-500 text-xs uppercase">
                  <th className="pb-2">Project</th>
                  <th className="pb-2">Status</th>
                  <th className="pb-2 text-right">Budget</th>
                  <th className="pb-2 text-right">Spent</th>
                  <th className="pb-2 text-right">%</th>
                </tr>
              </thead>
              <tbody>
                {data.operations.capitalProjects.map((p, idx) => (
                  <tr key={idx} className="border-t border-gray-100">
                    <td className="py-2">{p.name}</td>
                    <td className="py-2"><StatusBadge status={p.status} /></td>
                    <td className="py-2 text-right">{p.budget}</td>
                    <td className="py-2 text-right">{p.spent}</td>
                    <td className="py-2 text-right">{p.completion}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </MetricCard>

          <MetricCard title="Account-Level Variance" icon="√∞≈∏‚Äú‚Äπ">
            <table className="w-full text-sm">
              <thead>
                <tr className="text-left text-gray-500 text-xs uppercase">
                  <th className="pb-2">Account</th>
                  <th className="pb-2 text-right">Budgeted</th>
                  <th className="pb-2 text-right">Actual</th>
                  <th className="pb-2 text-right">Var</th>
                  <th className="pb-2">Status</th>
                </tr>
              </thead>
              <tbody>
                {data.operations.accountVariance.map((a, idx) => (
                  <tr key={idx} className="border-t border-gray-100">
                    <td className="py-2 text-xs">{a.account}</td>
                    <td className="py-2 text-right">{a.budgeted}</td>
                    <td className="py-2 text-right font-semibold">{a.actual}</td>
                    <td className="py-2 text-right">{a.variance}</td>
                    <td className="py-2"><StatusBadge status={a.status} /></td>
                  </tr>
                ))}
              </tbody>
            </table>
          </MetricCard>

          <MetricCard title="Facility Status" icon="√∞≈∏¬è¬¢">
            <table className="w-full text-sm">
              <thead>
                <tr className="text-left text-gray-500 text-xs uppercase">
                  <th className="pb-2">Facility</th>
                  <th className="pb-2">Status</th>
                  <th className="pb-2">Notes</th>
                </tr>
              </thead>
              <tbody>
                {data.operations.facilityStatus.map((f, idx) => (
                  <tr key={idx} className="border-t border-gray-100">
                    <td className="py-2">{f.facility}</td>
                    <td className="py-2"><StatusBadge status={f.status} /></td>
                    <td className="py-2 text-xs text-gray-500">{f.notes}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </MetricCard>
        </div>
      )}

      {/* ==========================================
          TAB: RECREATION DIVISION
          ========================================== */}
      {activeTab === 'recreation' && (
        <div className="space-y-4">
          {/* JIM DAILEY - FIRST */}
          <MetricCard title="Jim Dailey Fitness & Aquatics" icon="√∞≈∏¬è‚Äπ√Ø¬∏¬è">
            <div className="grid grid-cols-2 gap-4">
              <div>
                <h4 className="text-xs font-medium text-gray-500 mb-2">FITNESS</h4>
                <DataRow label="Active Memberships" current={data.recreation.jimDailey.memberships.current} priorYear={data.recreation.jimDailey.memberships.priorYear} />
                <DataRow label="Facility Visits" current={data.recreation.jimDailey.fitnessVisits.current} priorYear={data.recreation.jimDailey.fitnessVisits.priorYear} />
                <DataRow label="Group Fitness Classes" current={data.recreation.jimDailey.groupFitnessClasses.count} />
              </div>
              <div>
                <h4 className="text-xs font-medium text-gray-500 mb-2">AQUATICS</h4>
                <DataRow label="Swim Lessons" current={data.recreation.jimDailey.swimLessons.current} priorYear={data.recreation.jimDailey.swimLessons.priorYear} />
                <DataRow label="Pool Visits" current={data.recreation.jimDailey.poolVisits.current} priorYear={data.recreation.jimDailey.poolVisits.priorYear} />
                <DataRow label="Aquatics Classes" current={data.recreation.jimDailey.aquaticsClasses.count} />
              </div>
            </div>
            <div className="mt-3 pt-3 border-t">
              <DataRow label="Total Revenue" current={data.recreation.jimDailey.revenue.current} priorYear={data.recreation.jimDailey.revenue.priorYear} />
            </div>
          </MetricCard>

          {/* COMMUNITY CENTERS - SECOND */}
          <MetricCard title="Community Centers" icon="√∞≈∏¬è¬†">
            <table className="w-full text-sm">
              <thead>
                <tr className="text-left text-gray-500 text-xs uppercase">
                  <th className="pb-2">Center</th>
                  <th className="pb-2 text-right">Participants</th>
                  <th className="pb-2 text-right">Programs</th>
                  <th className="pb-2">Status</th>
                </tr>
              </thead>
              <tbody>
                {data.recreation.communityCenters.centers.map((c, idx) => (
                  <tr key={idx} className="border-t border-gray-100">
                    <td className="py-2">{c.name}</td>
                    <td className="py-2 text-right">{c.participants}</td>
                    <td className="py-2 text-right">{c.programs}</td>
                    <td className="py-2">{c.status && <StatusBadge status={c.status} />}</td>
                  </tr>
                ))}
              </tbody>
            </table>
            <div className="mt-3 pt-3 border-t">
              <DataRow label="Therapeutic Recreation Participants" current={data.recreation.communityCenters.therapeuticRec.participants} priorYear={data.recreation.communityCenters.therapeuticRec.priorYear} />
            </div>
          </MetricCard>

          {/* MUSEUM */}
          <MetricCard title="Museum of Military History" icon="√∞≈∏¬è‚Ä∫√Ø¬∏¬è">
            <div className="grid grid-cols-3 gap-3 mb-3">
              <StatBox value={data.recreation.museum.attendance.current} label="Monthly Attendance" sublabel={`PY: ${data.recreation.museum.attendance.priorYear}`} color="blue" />
              <StatBox value={data.recreation.museum.attendance.percentOfGoal} label="YTD vs Goal" sublabel={`Goal: ${data.recreation.museum.attendance.annualGoal}`} color="green" />
              <StatBox value={data.recreation.museum.fundraising.percentOfGoal} label="Fundraising vs Goal" sublabel={`YTD: ${data.recreation.museum.fundraising.ytd}`} color="green" />
            </div>
            <DataRow label="Off-Site Programming Reached" current={data.recreation.museum.offSiteProgramming.reached} />
          </MetricCard>

          {/* YOUTH ENGAGEMENT - THIRD */}
          <MetricCard title="Youth Engagement" icon="√∞≈∏‚Äò¬¶">
            <div className="grid grid-cols-4 md:grid-cols-8 gap-2">
              {Object.entries(data.recreation.youthEngagement).map(([sport, vals]) => (
                <div key={sport} className="text-center p-2 bg-gray-50 rounded">
                  <div className="text-lg font-bold text-gray-800">{vals.current}</div>
                  <div className="text-xs text-gray-500 capitalize">{sport.replace(/([A-Z])/g, ' $1').trim()}</div>
                  <div className="text-xs text-gray-400">PY: {vals.priorYear}</div>
                </div>
              ))}
            </div>
          </MetricCard>

          {/* GOLF - FOURTH */}
          <MetricCard title="Golf Operations (Rebsamen + First Tee)" icon="√¢‚Ä∫¬≥">
            <div className="grid grid-cols-2 gap-4 mb-4">
              <div>
                <h4 className="text-xs font-medium text-gray-500 mb-2">PERFORMANCE</h4>
                <DataRow label="Rounds Played" current={data.recreation.golf.rounds.current} priorYear={data.recreation.golf.rounds.priorYear} />
                <DataRow label="YTD Rounds" current={data.recreation.golf.rounds.ytd} priorYear={data.recreation.golf.rounds.priorYtd} />
                <DataRow label="Utilization Rate" current={data.recreation.golf.utilization.current} benchmark={data.recreation.golf.utilization.target} />
                <DataRow label="Revenue per Round" current={data.recreation.golf.revenuePerRound.current} priorYear={data.recreation.golf.revenuePerRound.priorYear} />
                <DataRow label="Cost Recovery" current={data.recreation.golf.costRecovery.current} benchmark={data.recreation.golf.costRecovery.target} />
              </div>
              <div>
                <h4 className="text-xs font-medium text-gray-500 mb-2">REVENUE BREAKDOWN</h4>
                <DataRow label="Greens Fees" current={data.recreation.golf.revenue.greensFees.current} priorYear={data.recreation.golf.revenue.greensFees.priorYear} />
                <DataRow label="Cart Rentals" current={data.recreation.golf.revenue.cartRentals.current} priorYear={data.recreation.golf.revenue.cartRentals.priorYear} />
                <DataRow label="Pro Shop Sales" current={data.recreation.golf.revenue.proShopSales.current} priorYear={data.recreation.golf.revenue.proShopSales.priorYear} />
                <DataRow label="Lessons" current={data.recreation.golf.revenue.lessons.current} priorYear={data.recreation.golf.revenue.lessons.priorYear} />
                <DataRow label="Total Revenue" current={data.recreation.golf.revenue.total.current} priorYear={data.recreation.golf.revenue.total.priorYear} />
              </div>
            </div>
          </MetricCard>

          {/* TENNIS - FOURTH (with Golf) - LESSONS REMOVED */}
          <MetricCard title="Tennis Operations (Rebsamen Tennis Center)" icon="√∞≈∏≈Ω¬æ">
            <div className="grid grid-cols-2 gap-4 mb-4">
              <div>
                <h4 className="text-xs font-medium text-gray-500 mb-2">PERFORMANCE</h4>
                <DataRow label="Court Hours" current={data.recreation.tennis.courtHours.current} priorYear={data.recreation.tennis.courtHours.priorYear} />
                <DataRow label="Utilization Rate" current={data.recreation.tennis.utilization.current} benchmark={data.recreation.tennis.utilization.target} />
                <DataRow label="Prime Time Utilization" current={data.recreation.tennis.utilization.primeTime} benchmark="80%+" />
                <DataRow label="Tournaments Hosted" current={data.recreation.tennis.tournaments.current} priorYear={data.recreation.tennis.tournaments.priorYear} />
              </div>
              <div>
                <h4 className="text-xs font-medium text-gray-500 mb-2">LEAGUE PARTICIPATION</h4>
                <DataRow label="Adult League Teams" current={data.recreation.tennis.teams.adultLeagues.current} priorYear={data.recreation.tennis.teams.adultLeagues.priorYear} />
                <DataRow label="High School Teams" current={data.recreation.tennis.teams.highSchool.current} priorYear={data.recreation.tennis.teams.highSchool.priorYear} />
                <DataRow label="Mixed Doubles Teams" current={data.recreation.tennis.teams.mixedDoubles.current} priorYear={data.recreation.tennis.teams.mixedDoubles.priorYear} />
                <DataRow label="Tri-Level Teams" current={data.recreation.tennis.teams.triLevel.current} priorYear={data.recreation.tennis.teams.triLevel.priorYear} />
              </div>
            </div>
            <div>
              <h4 className="text-xs font-medium text-gray-500 mb-2">REVENUE</h4>
              <div className="grid grid-cols-3 gap-2">
                <StatBox value={data.recreation.tennis.revenue.courtRentals.current} label="Court Rentals" color="green" />
                <StatBox value={data.recreation.tennis.revenue.tournaments.current} label="Tournaments" color="green" />
                <StatBox value={data.recreation.tennis.revenue.total.current} label="Total" color="green" />
              </div>
            </div>
          </MetricCard>

          {/* RENTALS - FIFTH */}
          <MetricCard title="Rentals" icon="√∞≈∏¬è‚Ä¢√Ø¬∏¬è">
            <DataRow label="Pavilion Rentals" current={data.recreation.rentals.pavilionRentals.current} priorYear={data.recreation.rentals.pavilionRentals.priorYear} />
            <DataRow label="Pavilion Revenue" current={data.recreation.rentals.pavilionRevenue.current} priorYear={data.recreation.rentals.pavilionRevenue.priorYear} />
            <p className="text-xs text-orange-600 mt-2">√¢≈°¬†√Ø¬∏¬è Suspension Period: {data.recreation.rentals.suspensionPeriod}</p>
          </MetricCard>

          {/* SPECIAL EVENTS - SIXTH */}
          <MetricCard title="Special Events" icon="√∞≈∏≈Ω‚Ä∞">
            {Object.entries(data.recreation.specialEvents).map(([category, events]) => (
              <div key={category} className="mb-4 last:mb-0">
                <h4 className="text-xs font-semibold text-gray-500 uppercase mb-2">
                  {category === 'signature' && '√∞≈∏¬è‚Ä† Signature Events'}
                  {category === 'community' && '√∞≈∏¬èÀú√Ø¬∏¬è Community Events'}
                  {category === 'revenueGenerating' && '√∞≈∏‚Äô¬∞ Revenue-Generating'}
                  {category === 'healthFitness' && '√∞≈∏¬è∆í Health & Fitness'}
                </h4>
                <table className="w-full text-sm">
                  <thead>
                    <tr className="text-left text-gray-400 text-xs">
                      <th className="pb-1">Event</th>
                      <th className="pb-1 text-right">Attendance</th>
                      <th className="pb-1 text-right">PY</th>
                      <th className="pb-1 text-right">Revenue</th>
                    </tr>
                  </thead>
                  <tbody>
                    {events.map((e, idx) => (
                      <tr key={idx} className="border-t border-gray-50">
                        <td className="py-1">{e.name}</td>
                        <td className="py-1 text-right font-semibold">{e.attendance}</td>
                        <td className="py-1 text-right text-gray-500">{e.priorYear}</td>
                        <td className="py-1 text-right">{e.revenue}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            ))}
          </MetricCard>

          {/* OUTDOOR RECREATION - SEVENTH (NEW PLACEHOLDER) */}
          <MetricCard title="Outdoor Recreation" icon="√∞≈∏≈í¬≤">
            <div className="text-center py-8 text-gray-400">
              <p className="text-sm">New position √¢‚Ç¨‚Äù metrics to be defined</p>
              <p className="text-xs mt-2">Future metrics may include: trails, playgrounds, sports fields, outdoor amenities</p>
            </div>
          </MetricCard>
        </div>
      )}

      {/* ==========================================
          TAB: VOLUNTEER DIVISION
          ========================================== */}
      {activeTab === 'volunteer' && (
        <div className="space-y-4">
          <MetricCard title="Volunteer Summary" icon="√∞≈∏¬§¬ù">
            <div className="grid grid-cols-3 gap-3 mb-4">
              <StatBox value={data.volunteers.totalHours.ytd} label="Total Hours YTD" sublabel={`PY: ${data.volunteers.totalHours.priorYtd}`} color="purple" />
              <StatBox value={data.volunteers.totalVolunteers.current} label="Active Volunteers" sublabel={`PY: ${data.volunteers.totalVolunteers.priorYear}`} color="purple" />
              <StatBox value={data.volunteers.yoyTrend} label="YoY Trend" sublabel="vs Q1-Q3 2024" color="green" />
            </div>
          </MetricCard>

          <MetricCard title="Volunteer Programs" icon="√∞≈∏‚Äú‚Äπ">
            <DataRow label="Available Programs" current={data.volunteers.availablePrograms} />
            <DataRow label="Volunteer Park Ranger Hours" current={data.volunteers.programs.volunteerParkRangers.hours} benchmark={`Req: ${data.volunteers.programs.volunteerParkRangers.required}`} />
            <DataRow label="Volunteer Park Rangers (Count)" current={data.volunteers.programs.volunteerParkRangers.count} />
            <DataRow label="Jr. Park Rangers" current={data.volunteers.programs.jrParkRangers.count} priorYear={data.volunteers.programs.jrParkRangers.priorYear} />
            <DataRow label="Adopt-A-Park Participants" current={data.volunteers.programs.adoptAPark.participants} benchmark={`${data.volunteers.programs.adoptAPark.opportunities} opportunities`} />
          </MetricCard>

          <MetricCard title="Background Checks" icon="√¢≈ì‚Ä¶">
            <p className="text-sm text-gray-600">{data.volunteers.backgroundChecks}</p>
          </MetricCard>
        </div>
      )}

      {/* ==========================================
          TAB: SAFETY DIVISION
          ========================================== */}
      {activeTab === 'safety' && (
        <div className="space-y-4">
          <MetricCard title="Training & Inspections" icon="√∞≈∏‚Äú‚Äπ">
            <ComplianceRow label="Staff Safety Training" completion={data.safety.training.completion} completed={data.safety.training.staffCompleted} total={data.safety.training.staffTotal} status={data.safety.training.status} />
            <ComplianceRow label="Facility Safety Inspections" completion={data.safety.facilityInspections.completion} completed={data.safety.facilityInspections.completed} total={data.safety.facilityInspections.total} status={data.safety.facilityInspections.status} />
          </MetricCard>

          <MetricCard title="Fire Safety Systems" icon="√∞≈∏‚Äù¬•">
            <ComplianceRow label="Fire Extinguisher Checks" completion={data.safety.fireSafety.extinguishers.completion} completed={data.safety.fireSafety.extinguishers.completed} total={data.safety.fireSafety.extinguishers.total} status={data.safety.fireSafety.extinguishers.status} />
            <ComplianceRow label="Fire Alarm Checks" completion={data.safety.fireSafety.alarms.completion} completed={data.safety.fireSafety.alarms.completed} total={data.safety.fireSafety.alarms.total} status={data.safety.fireSafety.alarms.status} />
            <ComplianceRow label="Fire Control Panel Checks" completion={data.safety.fireSafety.controlPanels.completion} completed={data.safety.fireSafety.controlPanels.completed} total={data.safety.fireSafety.controlPanels.total} status={data.safety.fireSafety.controlPanels.status} />
          </MetricCard>

          <MetricCard title="AED & Medical" icon="√∞≈∏¬è¬•">
            <ComplianceRow label="AED Operational Checks" completion={data.safety.aed.operationalChecks.completion} completed={data.safety.aed.operationalChecks.completed} total={data.safety.aed.operationalChecks.total} status={data.safety.aed.operationalChecks.status} />
            <div className="mt-3 pt-3 border-t">
              <span className="text-xs text-gray-500 font-medium">AED/CPR/FIRST AID RECERTS OUTSTANDING:</span>
              <div className="flex flex-wrap gap-2 mt-2">
                {data.safety.aed.recertsOutstanding.map((name, idx) => (
                  <span key={idx} className="px-2 py-1 bg-red-100 text-red-700 text-xs rounded">{name}</span>
                ))}
              </div>
            </div>
          </MetricCard>

          <MetricCard title="Playground Safety" icon="√∞≈∏‚Ä∫¬ù">
            <DataRow label="Inspections Completed" current={data.safety.playgrounds.inspectionsCompleted} benchmark={`of ${data.safety.playgrounds.inspectionsScheduled}`} />
            <DataRow label="Historical Rate (2017-present)" current={data.safety.playgrounds.historicalRate} />
          </MetricCard>

          <MetricCard title="Active Safety Hazards" icon="√∞≈∏≈°¬®">
            <table className="w-full text-sm">
              <thead>
                <tr className="text-left text-gray-500 text-xs uppercase">
                  <th className="pb-2">Location</th>
                  <th className="pb-2">Issue</th>
                  <th className="pb-2">Priority</th>
                  <th className="pb-2">Status</th>
                </tr>
              </thead>
              <tbody>
                {data.safety.activeHazards.map((h, idx) => (
                  <tr key={idx} className="border-t border-gray-100">
                    <td className="py-2 font-medium">{h.location}</td>
                    <td className="py-2 text-xs text-gray-600">{h.issue}</td>
                    <td className="py-2"><StatusBadge status={h.priority} /></td>
                    <td className="py-2"><StatusBadge status={h.status} /></td>
                  </tr>
                ))}
              </tbody>
            </table>
          </MetricCard>

          <MetricCard title="Incident Reports" icon="√∞≈∏‚Äú¬ù">
            <div className="grid grid-cols-3 gap-3">
              <StatBox value={data.safety.incidents.current} label="This Month" color="gray" />
              <StatBox value={data.safety.incidents.priorYear} label="Same Month PY" color="gray" />
              <StatBox value={data.safety.incidents.ytd} label="YTD Total" color="gray" />
            </div>
          </MetricCard>
        </div>
      )}

      {/* ==========================================
          TAB: BUDGET DETAIL
          ========================================== */}
      {activeTab === 'budget' && (
        <div className="space-y-4">
          <MetricCard title="Budget vs. Actual" icon="√∞≈∏‚Äú≈†">
            <table className="w-full text-sm">
              <thead>
                <tr className="text-left text-gray-500 text-xs uppercase">
                  <th className="pb-2">Category</th>
                  <th className="pb-2 text-right">Annual</th>
                  <th className="pb-2 text-right">YTD Budget</th>
                  <th className="pb-2 text-right">YTD Actual</th>
                  <th className="pb-2 text-right">Variance</th>
                </tr>
              </thead>
              <tbody>
                <tr className="border-t">
                  <td className="py-2 font-medium">Operating Expenditures</td>
                  <td className="py-2 text-right">{data.budget.operating.annual}</td>
                  <td className="py-2 text-right">{data.budget.operating.ytdBudget}</td>
                  <td className="py-2 text-right">{data.budget.operating.ytdActual}</td>
                  <td className="py-2 text-right">{data.budget.operating.variance}</td>
                </tr>
                <tr className="border-t">
                  <td className="py-2 font-medium">Revenue</td>
                  <td className="py-2 text-right">{data.budget.revenue.annual}</td>
                  <td className="py-2 text-right">{data.budget.revenue.ytdBudget}</td>
                  <td className="py-2 text-right">{data.budget.revenue.ytdActual}</td>
                  <td className="py-2 text-right">{data.budget.revenue.variance}</td>
                </tr>
              </tbody>
            </table>
          </MetricCard>

          <MetricCard title="Monthly Revenue Trend" icon="√∞≈∏‚Äô¬µ">
            <div className="grid grid-cols-3 gap-3">
              <StatBox value={data.budget.revenue.monthly.current} label="Current Month" color="green" />
              <StatBox value={data.budget.revenue.monthly.priorYear} label="Same Month PY" color="gray" />
              <StatBox value={data.budget.revenue.monthly.variance} label="YoY Change" color={data.budget.revenue.monthly.variance.includes('-') ? 'red' : 'green'} />
            </div>
          </MetricCard>

          <MetricCard title="Key Ratios vs. Peers" icon="√∞≈∏‚ÄúÀÜ">
            <div className="grid grid-cols-3 gap-3">
              <div className="text-center p-3 bg-green-50 rounded-lg">
                <div className="text-xl font-bold text-green-700">{data.budget.costRecovery.current}</div>
                <div className="text-xs text-gray-500">Cost Recovery</div>
                <div className="text-xs text-blue-600">Peer: {data.budget.costRecovery.peerBenchmark}</div>
              </div>
              <div className="text-center p-3 bg-green-50 rounded-lg">
                <div className="text-xl font-bold text-green-700">{data.budget.perCapitaSpend.current}</div>
                <div className="text-xs text-gray-500">$ per Capita</div>
                <div className="text-xs text-blue-600">Peer: {data.budget.perCapitaSpend.peerBenchmark}</div>
              </div>
              <div className="text-center p-3 bg-green-50 rounded-lg">
                <div className="text-xl font-bold text-green-700">{data.budget.generalFundPct.current}</div>
                <div className="text-xs text-gray-500">General Fund %</div>
                <div className="text-xs text-blue-600">Peer: {data.budget.generalFundPct.peerBenchmark}</div>
              </div>
            </div>
          </MetricCard>
        </div>
      )}

      {/* ==========================================
          TAB: LR vs PEERS
          ========================================== */}
      {activeTab === 'peers' && (
        <div className="space-y-4">
          <MetricCard title="Little Rock vs. NRPA Peer Benchmarks" icon="√∞≈∏‚Äú≈†">
            <p className="text-xs text-gray-500 mb-3">Population 100K-250K | Source: {data.peerComparison.source}</p>
            <table className="w-full text-sm">
              <thead>
                <tr className="text-left text-gray-500 text-xs uppercase">
                  <th className="pb-2">Metric</th>
                  <th className="pb-2 text-right text-green-600">Little Rock</th>
                  <th className="pb-2 text-right text-blue-600">NRPA Median</th>
                  <th className="pb-2 text-right">Lower Q</th>
                  <th className="pb-2 text-right">Upper Q</th>
                  <th className="pb-2 text-right">LR vs Median</th>
                </tr>
              </thead>
              <tbody>
                {data.peerComparison.metrics.map((m, idx) => (
                  <tr key={idx} className="border-t border-gray-100">
                    <td className="py-2">{m.metric}</td>
                    <td className="py-2 text-right font-semibold text-green-700">{m.lr}</td>
                    <td className="py-2 text-right text-blue-600">{m.nrpaMedian}</td>
                    <td className="py-2 text-right text-gray-400">{m.lowerQuartile}</td>
                    <td className="py-2 text-right text-gray-400">{m.upperQuartile}</td>
                    <td className="py-2 text-right font-semibold">{m.lrVsMedian}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </MetricCard>

          <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <h4 className="font-medium text-blue-800 mb-2">√∞≈∏‚Äú≈í Key Insights</h4>
            <ul className="text-sm text-gray-700 space-y-1">
              <li>√¢‚Ç¨¬¢ Little Rock is the only major AR city <strong>without dedicated parks funding</strong> (no sales tax)</li>
              <li>√¢‚Ç¨¬¢ General Fund structure creates <strong>no feedback loop</strong> √¢‚Ç¨‚Äù parks revenue flows to city, not retained</li>
              <li>√¢‚Ç¨¬¢ Cost recovery of <strong>{data.budget.costRecovery.current}</strong> vs. peer median of <strong>{data.budget.costRecovery.peerBenchmark}</strong></li>
              <li>√¢‚Ç¨¬¢ Peer cities average <strong>62% General Fund</strong>, <strong>21% earned revenue</strong>, <strong>8% voter-approved taxes</strong></li>
            </ul>
          </div>

          <MetricCard title="Peer City Quick Reference" icon="√∞≈∏¬è‚Ñ¢√Ø¬∏¬è">
            <div className="text-xs text-gray-600 space-y-2">
              <p><strong>NRPA Benchmarks (100K-250K Pop):</strong></p>
              <ul className="list-disc list-inside space-y-1 ml-2">
                <li>Operating Budget: 54% personnel, 38% operating, 6% capital</li>
                <li>Funding Sources: 62% general fund, 21% earned revenue, 8% taxes</li>
                <li>Capital Split: 67% renovation vs 33% new construction</li>
                <li>Capital Allocation: 70% parks vs 30% buildings</li>
              </ul>
              <p className="mt-3"><strong>Dashboard Models:</strong> Springfield MO (OpenGov), Minneapolis (Power BI CIP), Seattle (multi-dashboard)</p>
              <p><strong>Resources:</strong> <a href="https://www.nrpa.org/publications-research/ParkMetrics/" className="text-blue-600 underline">NRPA Park Metrics</a> | <a href="https://parkserve.tpl.org/mapping/" className="text-blue-600 underline">TPL ParkServe</a></p>
            </div>
          </MetricCard>
        </div>
      )}

      {/* Footer */}
      <div className="mt-6 text-center text-xs">
        <div className="font-medium text-gray-300">Little Rock Parks & Recreation Commission</div>
        <div className="mt-1 text-gray-400">City of Little Rock, Arkansas</div>
        <div className="mt-1 text-gray-400">
          <a href="about.html" className="hover:text-white transition-colors">Independently maintained as a public resource</a>
        </div>
        <div className="mt-3 text-gray-400">Dashboard v7.0 (Google Sheets) ‚Ä¢ Data as of {data.reportMonth}</div>
      </div>
    </div>
  );
};
        
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Dashboard />);
    </script>
</body>
</html>
